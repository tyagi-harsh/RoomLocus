<div class="owner-container">

  <!-- Top Section: Lead Counter -->
  <div class="top-stats">
    <h2>Lead Left: {{ leadCount }}</h2>
    <button class="btn-buy-lead" (click)="buyLead()">Buy Lead</button>
  </div>

  <!-- Teal Tab Bar -->
  <div class="owner-tabs">
    <div class="tab-item" [class.active]="activeTab === 'rentals'" (click)="setActiveTab('rentals')">
      My Rentals
    </div>
    <div class="tab-item" [class.active]="activeTab === 'used-lead'" (click)="setActiveTab('used-lead')">
      Used Lead
    </div>
    <div class="tab-item" [class.active]="activeTab === 'guide'" (click)="setActiveTab('guide')">
      Guide
    </div>
  </div>

  <!-- Content Area -->
  <div class="main-content">

    <!-- SECTION: Used Lead (Active) -->
    <div *ngIf="activeTab === 'used-lead'">

      <!-- Sub Header (Gray Bar) -->
      <div class="sub-header">
        Customer Visited Your Profile
      </div>

      <!-- Responsive Grid for Cards -->
      <div class="card-grid">
        <div class="card" *ngFor="let item of paginatedLeads">

          <!-- Card Header -->
          <div class="card-top">
            <span class="cat">{{ item.category }}</span> |
            <span class="loc">{{ item.location }}</span> |
            <span class="loc">{{ item.subLocation }}</span>
          </div>

          <!-- Card Body -->
          <div class="card-body">
            <!-- Left Info -->
            <div class="info-col">
              <div class="name-row">Name: <span class="name-val">{{ item.name }}</span></div>
              <div class="detail-row">Mob No.: {{ item.mobile }}</div>
              <div class="detail-row">Date: {{ item.date }}</div>
            </div>

            <!-- Right Actions -->
            <div class="action-col">
              <button class="btn-call" (click)="callLead(item.mobile)">Call</button>
              <button class="btn-delete" (click)="deleteLead(item.id)">
                <i class="fa-regular fa-trash-can"></i>
              </button>
            </div>
          </div>

        </div>
      </div>

      <mat-paginator *ngIf="leads.length > leadsPageSize" [length]="leads.length" [pageSize]="leadsPageSize"
        [hidePageSize]="true" [pageIndex]="leadsCurrentPage" (page)="onLeadsPageChange($event)" showFirstLastButtons
        aria-label="Select page">
      </mat-paginator>

    </div>
    <!-- End Used Lead Section -->

    <!-- Placeholders for other tabs -->
    <div *ngIf="activeTab === 'rentals'" class="owner-rentals">
      <div class="rental-actions">
        <button type="button" class="btn-add-property" (click)="openAddRentalDialog()">Add New Property +</button>
      </div>
      <h3>My Rentals</h3>
      <p class="subtext" *ngIf="!ownerId">Log in as an owner to view your rentals.</p>
      <p class="subtext" *ngIf="ownerId && !isLoadingRentals && properties?.length === 0">No rentals yet. Add a property to see it here.</p>
      <div *ngIf="rentalsError" class="error-text">{{ rentalsError }}</div>

      <div *ngIf="isLoadingRentals" class="property-list loading-grid">
        <div class="property-card skeleton" *ngFor="let _ of [1,2,3]">
          <div class="image shimmer"></div>
          <div class="lines">
            <span></span><span></span><span></span>
          </div>
        </div>
      </div>

      <div *ngIf="!isLoadingRentals && properties?.length" class="property-list">
        <article class="property-card" *ngFor="let property of properties; trackBy: trackByPropertyId">
          <div class="property-card-media">
            <img [src]="property.thumbnailUrl || property.imageUrls?.[0] || 'https://placehold.co/320x200?text=No+Image'" alt="Property image">
          </div>
          <div class="property-card-body">
            <div class="property-card-header">
              <span class="type">{{ property.propertyType || 'Property' }}</span>
              <span class="status" [ngClass]="property.status?.toLowerCase()">{{ property.status || 'PENDING' }}</span>
            </div>
            <a class="property-card-title" [routerLink]="['/property', property.propertyId]">{{ property.title || 'Untitled property' }}</a>
            <p class="property-card-location">{{ property.addressLine || property.locality || property.city }}</p>
            <p class="property-card-meta">{{ property.city }}, {{ property.state }} {{ property.pincode }}</p>
            <div class="property-card-footer">
              <div class="rent" *ngIf="property.rent">â‚¹ {{ property.rent | number }}</div>
              <div class="date">Added {{ property.createdAt | date:'mediumDate' }}</div>
            </div>
          </div>
        </article>
      </div>

      <mat-paginator *ngIf="!isLoadingRentals && totalRentals > rentalsPageSize" [length]="totalRentals"
        [pageSize]="rentalsPageSize" [hidePageSize]="true" [pageIndex]="rentalsCurrentPage"
        (page)="onRentalsPageChange($event)" showFirstLastButtons aria-label="Select page">
      </mat-paginator>
    </div>

    <div *ngIf="activeTab === 'guide'" class="placeholder-tab">
      <h3>Owner Guide</h3>
      <p>Helpful tips for owners.</p>
    </div>

  </div>
</div>