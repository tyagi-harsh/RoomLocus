<div class="owner-container">

  <!-- Top Section: Lead Counter -->
  <div class="top-stats">
    <h2>Lead Left: {{ leadCount }}</h2>
    <button class="btn-buy-lead" (click)="buyLead()">Buy Lead</button>
  </div>

  <!-- Teal Tab Bar -->
  <div class="owner-tabs">
    <div class="tab-item" [class.active]="activeTab === 'rentals'" (click)="setActiveTab('rentals')">
      My Rentals
    </div>
    <div class="tab-item" [class.active]="activeTab === 'used-lead'" (click)="setActiveTab('used-lead')">
      Used Lead
    </div>
    <div class="tab-item" [class.active]="activeTab === 'guide'" (click)="setActiveTab('guide')">
      Guide
    </div>
  </div>

  <!-- Content Area -->
  <div class="main-content">

    <!-- SECTION: Used Lead (Active) -->
    <div *ngIf="activeTab === 'used-lead'">

      <!-- Sub Header (Gray Bar) -->
      <div class="sub-header">
        Customer Visited Your Profile
      </div>

      <!-- Responsive Grid for Cards -->
      <div class="card-grid">
        <div class="card" *ngFor="let item of paginatedLeads">

          <!-- Card Header -->
          <div class="card-top">
            <span class="cat">{{ item.category }}</span> |
            <span class="loc">{{ item.location }}</span> |
            <span class="loc">{{ item.subLocation }}</span>
          </div>

          <!-- Card Body -->
          <div class="card-body">
            <!-- Left Info -->
            <div class="info-col">
              <div class="name-row">Name: <span class="name-val">{{ item.name }}</span></div>
              <div class="detail-row">Mob No.: {{ item.mobile }}</div>
              <div class="detail-row">Date: {{ item.date }}</div>
            </div>

            <!-- Right Actions -->
            <div class="action-col">
              <button class="btn-call" (click)="callLead(item.mobile)">Call</button>
              <button class="btn-delete" (click)="deleteLead(item.id)">
                <i class="fa-regular fa-trash-can"></i>
              </button>
            </div>
          </div>

        </div>
      </div>

      <mat-paginator *ngIf="leads.length > leadsPageSize" [length]="leads.length" [pageSize]="leadsPageSize"
        [hidePageSize]="true" [pageIndex]="leadsCurrentPage" (page)="onLeadsPageChange($event)" showFirstLastButtons
        aria-label="Select page">
      </mat-paginator>

    </div>
    <!-- End Used Lead Section -->

    <!-- Placeholders for other tabs -->
    <div *ngIf="activeTab === 'rentals'" class="owner-rentals">
      <div class="rental-actions">
        <button type="button" class="btn-add-property" (click)="openAddRentalDialog()">Add New Property +</button>
      </div>
      <h3>My Rentals</h3>
      <p class="subtext" *ngIf="!ownerId">Log in as an owner to view your rentals.</p>
      <div *ngIf="rentalsError" class="error-text">{{ rentalsError }}</div>
      <div *ngIf="isLoadingRentals" class="loading-indicator">Loading rentalsâ€¦</div>
      <p class="subtext" *ngIf="ownerId && !isLoadingRentals && !ownerCards.length && !rentalsError">No rentals yet. Add a property to see it here.</p>

      <div class="wishlist-grid" *ngIf="!isLoadingRentals && ownerCards.length">
        <div class="card wishlist-card" *ngFor="let item of ownerCards; trackBy: trackByCardId">

          <div class="wishlist-img-container">
            <img [src]="item.imageUrl" alt="Property Image">
            <img
              [src]="item.verified ? 'assets/images/icons/new_verified_logo_n.png' : 'assets/images/icons/not_verified_n.png'"
              alt="Verification badge" class="verified-badge" />
          </div>

          <div class="wishlist-details">
            <div class="w-location">{{ item.location }}<span *ngIf="item.landmark"> , {{ item.landmark }}</span></div>
            <div class="w-subtext">{{ item.townSector ? item.townSector + ', ' : '' }}{{ formatCity(item.city) }} | {{
              item.propertyType || 'N/A' }}</div>
            <div class="w-price">{{ item.price }} <span class="period">{{ item.pricePeriod }}</span></div>
            <a class="w-link" [routerLink]="['/property', item.id]"
              [queryParams]="item.propertyCategory ? { type: item.propertyCategory } : undefined"
              [state]="{ verified: item.verified }">
              View Details
            </a>
          </div>

        </div>
      </div>

      <mat-paginator *ngIf="!isLoadingRentals && totalRentals > rentalsPageSize" [length]="totalRentals"
        [pageSize]="rentalsPageSize" [hidePageSize]="true" [pageIndex]="rentalsCurrentPage"
        (page)="onRentalsPageChange($event)" showFirstLastButtons aria-label="Select page">
      </mat-paginator>
    </div>

    <div *ngIf="activeTab === 'guide'" class="placeholder-tab">
      <h3>Owner Guide</h3>
      <p>Helpful tips for owners.</p>
    </div>

  </div>
</div>